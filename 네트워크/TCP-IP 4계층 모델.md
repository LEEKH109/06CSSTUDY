# 1. 계층 구조  
![OSI,IP](https://github.com/SSAFYSEOUL06CSSTUDY/06CSSTUDY/assets/50236187/a5c6a2bd-9efc-47b0-8f06-e3ce7c592bab)  

## 1-1. OSI 7계층

### 7계층 - 응용 계층(Application)  
> User Interface 를 제공하는 계층 
- 사용자와 가장 밀접한 계층, 인터페이스(Interface) 역할
- 응용 프로세스 간의 정보 교환 담당 / 전송 단위 : Message
- EX : 전자 메일, 인터넷, 동영상 플레이어 등의 Applicasation

### 6계층 – 표현 계층(Presentation)
> 데이터의 변환 작업을 하는 계층  
- 데이터 표현에 차이가 있는 응용처리에서의 제어구조를 제공 ※ 데이터 표현에 차이 : ASCII, JPEG, MPEG 등의 번역
- 전송하는 데이터의 인코딩, 디코딩, 암호화, 코드 변환 등을 수행 / 전송 단위 : Message

### 5계층 - 세션 계층(Session)  
> 응용 프로그램 간의 연결을 지원해주는 계층  
- 통신장치 간 상호작용 및 동기화를 제공
- 연결 세션에서 데이터 교환,  에러 발생 시 복구 관리 => 논리적 연결 담당 / 전송 단위 : Message
- 4계층 장비 : NetBIOS (세션 내 연결관리 및 에러감지, 복구 수행), SSH, Appletalk  (Port는 4~5계층 경계 모호)

### 4계층 - 전송 계층(Transport)
> 서비스를 구분하고 데이터의 전송 방식을 담당하는 계층 (TCP/UDP)  
- 종단 간(End-to-End)에 신뢰성 있고 정확한 데이터 전송을 담당 / 전송 단위 : Segment
- 4계층에서 전송 되는 단위 => 세그먼트(Segment), 종단 간의 에러 복구와 흐름 제어 담당  ex) TCP/UDP
- 4계층 장비 : L4 스위치 (3계층 트래픽 분석, 서비스 종류 구분)

### 3계층 - 네트워크 계층(Network)
> 네트워크를 논리적으로 구분하고 연결하는 계층  
- 중계 노드를 통하여 전송하는 경우, 어떻게 중계할 것인가를 규정  / 전송 단위 : Packet
- 데이터를 목적지까지 가장 안전하고 빠르게 전달 => 라우팅
- 3계층 장비 : 라우터, L3 스위치

### 2계층 - 데이터 링크 계층(Data Link)  
> 물리적 매체에 패킷 데이터를 실어 보내는 계층  
- 물리적인 연결을 통하여 인접한 두 장치간의 신뢰성 있는 정보 전송을 담당(전송 단위 : Frame)
- 정보의 오류와 흐름을 관리. 안정된 정보 전달
- 2계층 장비 : 브리지, 스위치

### 1계층 - 물리 계층(Physical)  
> 신호로 변환하여 전송하는 계층    
- 전기적, 기계적 특성을 이용하여 통신 케이블로 전기적 신호(에너지)를 전송(전송 단위 : bit)
- 데이터 전달 역할만 함, 오류 제어 기능 X
- 1계층 장비 : 리피터, 허브, 케이블

# 1-2. TCP/IP 4계층

### 4계층 - 응용 계층
> TCP/UDP 기반의 응용 프로그램을 구현할 때 사용
- OSI 7계층의 세션 계층, 표현 계층, 응용 계층에 해당
- 프로토콜 – FTP, HTTP, SSH, SMTP, DNS  

<details>
<summary>프로토콜</summary>
  
> - FTP : 장치와 장치 간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜
> - SSH : 보안되지 않은 네트워크에서 네트워크 서비스를 안전하게 운영하기 위한 암호화 네트워크 프로토콜
> - HTTP : World Wide Web을 위한 데이터 통신의 기초이자 웹 사이트를 이용하는 데 쓰는 프로토콜
> - SMTP : 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
> - DNS : 도메인 이름과 IP 주소를 매핑해주는 서버

</details>

### 3계층 - 전송 계층
> 통신 노드 간의 연결을 제어하고, 신뢰성 있는 데이터 전송 담당
- OSI 7계층의 전송 계층에 해당
- 프로토콜 – TCP, UDP
- TCP는 가상회선 패킷 교환 방식, UDP는 데이터그램 패킷 교환 방식
- TCP는 신뢰성 확보를 위해 3-way handshake 작업 진행, UDP는 이 과정이 없기 때문에 신뢰성이 없다

<details>
<summary>교환 방식</summary>
  
> 가상회선 패킷 교환 방식
<img width="455" alt="가상회선 패킷 교환 방식" src="https://github.com/namoo1818/TIL/assets/50236187/388037ab-46a7-464f-ae56-b91d4f53def2">
</br>

각 패킷에는 가상회선 식별자가 포함되며 모든 패킷을 전송하면 가상회선이 해체되고 패킷들은 전송된 `순서대로` 도착하는 방식

> 데이터그램 패킷 교환 방식
<img width="435" alt="데이터그램 패킷 교환 방식" src="https://github.com/namoo1818/TIL/assets/50236187/164be939-10b4-4d95-815e-3ec86a46bed2">
</br>

패킷이 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송될 수 있으며 도착한 `순서가 다를 수` 있는 방식

</details>

<details>
<summary>3-way handshake</summary>
<img src="https://github.com/namoo1818/TIL/assets/50236187/7e5dfbea-7ac6-42d6-9e2d-e18f48399561" width="400">
</br>

데이터 전송 전에 송신자와 수신자 사이에 세션을 수립하는 과정  
1. SYN 단계 : 클라이언트는 서버에 클라이언트의 ISN을 담아 SYN을 보낸다
2. SYN + ACK 단계 : 서버는 클라이언트의 SYN을 수신하고 서버의 ISN을 보내며 승인번호로 클라이언트의 ISN+1을 보낸다
3. ACK 단계 : 클라이언트는 서버의 ISN+1한 값인 승인번호를 담아 ACK를 서버에 보낸다

> **용어**
> - SYN(SYNchronization): 연결 요청 플래그
> - ACK(ACKnowledgement): 응답 플래그
> - ISN(Initial Sequence Numbers) : 초기 네트워크 연결을 할 때 할당된 32비트 고유 시퀀스 번호

</details>

<details>
<summary>4-way handshake</summary>
<img src="https://github.com/namoo1818/TIL/assets/50236187/fee3797c-cd53-43cd-a3da-babeaeb9f95c" width="400">
</br>

데이터를 주고 받은 뒤 연결을 해제하는 과정  

#### Step 1  
클라이언트는 연결을 종료하고자 서버에 FIN 플래그를 보내고 FIN_WAIT 상태에 들어간다.  

#### Step 2  
서버는 클라이언트로 부터 FIN 플래그를 받은 뒤 ACK 패킷을 보낸 후 데이터를 모두 보낼 때 까지 잠시 TIME_OUT 이 된다. 이 때 서버는 ClOSE_WAIT 상태이다.  

#### Step 3  
서버가 연결을 종료할 준비가 되면, 연결을 해제할 준비가 되었다는 FIN 플래그를 클라이언트에 전송하고, 서버는 LAST_ACK 상태가 된다.  

#### Step 4  
클라이언트는 서버에 ACK를 보내 응답하고 클라이언트의 상태는 FIN_WAIT 에서 TIME-WAIT 으로 변경된다. 클라이언트의 ACK 응답을 받은 서버는 연결을 해제한다.  
이 때, 클라이언트는 ACK 를 보낸 이후 일정 시간동안 기다리게 되는데, 아직 서버에서 받지 못한 데이터가 연결이 해제되어 유실되는 경우를 대비해 잉여 패킷을 기다리는 TIME_WAIT 상태를 일정 시간 유지하게 된다.  

</details>

### 2계층 - 인터넷 계층
> 통신 노드 간의 IP패킷을 전송하는 기능과 라우팅 기능을 담당
- OSI 7계층의 네트워크 계층에 해당
- 프로토콜 – IP, ARP, RARP

### 1계층 - 네트워크 접근 계층(링크 계층)
> 물리적인 주소로 MAC을 사용
- OSI 7계층의 물리계층과 데이터 링크 계층에 해당
- LAN, 패킷망, 등에 사용
  
